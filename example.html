<!DOCTYPE html />
<html>
<head>
    <title>EditTable Example</title>
    <style>
        td.disabled, th.disabled {
            background-color: #ccc;
        }
    </style>
</head>
<body>
<h1>EditTable Example</h1>
<p>This shows a basic example of EditTable.</p>
<p>Click any of the table cells below to edit them.  Also try navigating around with the keyboard (tab, shift+tab, up, down).</p>

<table id='my_table' border="1" cellspacing="0" cellpadding="10">
    <thead>
    <tr>
        <th>Name</th>
        <th>Gender</th>
        <th>Description</th>
        <th>Generated Email</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>John Smith</td>
        <td>Male</td>
        <td>Famous for having the most popular male fake name.</td>
        <td></td>
    </tr>
    <tr>
        <td>Jane Doe</td>
        <td>Female</td>
        <td>Friend of John Smith.</td>
        <td></td>
    </tr>
    <tr>
        <td>John Doe</td>
        <td>Male</td>
        <td>Husband of Jane Doe and extremely jealous of John Smith.</td>
        <td></td>
    </tr>
    </tbody>
</table>

<button id="reset" type="button">Reset</button>
<button id="log" type="button">Console.log</button>
<button id="addrow" type="button">Add Row</button>
<button id="removerow" type="button">Remove Row</button>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
<script src='lib/EditTable.js' type='text/javascript'></script>
<script type='text/javascript'>

var table = $("#my_table");

table.editTable({
    columns: {
        Gender: {
            editor: 'select',
            options: {
                values:['Male','Female']
            }
        },
        'Generated Email': {
            disabled: true,
            'class': 'disabled'
        }
    },
    set: function(e,cell) {
        // Bold the 'Name' column and use it to generate an email
        if(cell.colname === "Name") {
            cell.el.html('<strong>'+cell.el.html()+'</strong>');
            
            var email = cell.value
                .toLowerCase()
                .replace(/\s+/g,'.')
                .replace(/[^a-z0-9\.\-_]+/g,'')+'@test.com';
                
            table.editTable('set', cell.row, 'Generated Email', email);
        }
        // Make the email column a mailto link
        else if(cell.colname === "Generated Email") {
            cell.el.html('<a href="mailto:'+cell.value+'">'+cell.el.html()+'</a>');
        }
    }
});

var orig = table.editTable('rows');
$("#reset").on('click',function() {
   table.editTable('rows',orig); 
});
$("#log").on('click',function() {
   console.log(table.editTable('rows')); 
});
$("#addrow").on('click',function() {
   table.editTable('add'); 
});
$("#removerow").on('click',function() {
   table.editTable('remove'); 
});

// jQueryUI isn't required.  This is just showing the integration with the
// ui.sortable plugin
table.sortable({
    items: 'tbody tr',
    update: function() {
       // We need to refresh the editTable plugin every time we manually
       // alter the table's DOM elements.
       table.editTable('refresh');
    }
});

</script>
</body>
</html>
